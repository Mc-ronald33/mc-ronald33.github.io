webpackJsonp([80,27],{322:function(e,t,i){"use strict";var n=i(11),r=i(5),s={log:function o(e,t){var i={event:e};n.isUndefined(t)||(i.sample_rate=t);var s=r.create("IncrementEventResource",i);s.callCreate({showError:!1})}};e.exports=s},718:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=i(34),s=n(r),o=i(14),a=n(o),u=i(11),l=i(46),c=i(9),d=i(956),p=i(1066),h=i(206),_=i(462),f=i(1397),m=i(1922),v=i(47),x=i(117),S=i(7),T=i(60),g=i(283),M=v.getLogger("ExperienceTutorialManager"),y=function P(){this.TUTORIAL_MAP={},this.TUTORIAL_MAP[0]=p,this.TUTORIAL_MAP[9]=m,this.TUTORIAL_MAP[8]=f,g.setExperienceTutorialManager(this),this.init()};y.prototype={init:function w(){this._isActive=!1,this.experience=null,this.tutorial=null,this.currentStep=0,this.steps=null},startTutorial:function I(e){var t=this;if(g.isTutorialActive())return Promise.reject(new Error("another tutorial is already active"));var i=this._getStoredData();return!i||e&&i.experience.id!==e.id||(e=i.experience,this.currentStep=i.step),e&&void 0!==e.type&&u.has(this.TUTORIAL_MAP,e.type)?(this._isActive=!0,this.experience=e,this.tutorial=new this.TUTORIAL_MAP[this.experience.type](this.experience,this),S.instance.subscribe("tutorial","tutorialGoToStep",function(e,i,n){t._setStep(n)}),this.tutorial.onStart().then(function(){return t.steps=t.experience.display_data.steps,t._funnelPrefix="tutorial_"+t.experience.id,t._setStep(t.currentStep)},function(){t._isActive=!1})):Promise.reject(new Error("invalid placedExperience or no placedExperience to be resumed"))},_next:function A(){return!this.steps||this.currentStep>=this.steps.length-1?this._endTutorial(!0,!0):this._setStep(this.currentStep+1)},_previous:function b(){return this.currentStep<=0?this._endTutorial(!1):this._setStep(this.currentStep-1)},_dismiss:function O(){this._endTutorial(!1)},_endTutorial:function N(e,t){var i=function(){var i=this.experience.experience_id,n=this.experience.display_data,r=n.nextUrlInfo,o=r?r.url:null,a=r?r.forceRefresh:!1,u=r?r.forceFullPageRefresh:!1,l=!!n.relaunchPlacement,c=l?this.experience.placement_id:null;this.clearStoredData(),this.init();var p=Promise.resolve();return e&&o?!function(){var e=new x;u?(0,s["default"])(o):a&&(e.evt=new d("",null,{forceRefresh:1})),_().then(function(t){t.navigate(o,e)})}():l&&c&&(p=h().then(function(e){return e.launchPlacedExperience(c)})),p.then(function(){t&&S.instance.publish(i,"pulserClicked",{})})}.bind(this),n=e?this.tutorial.completePlacedExperience():this.tutorial.dismissPlacedExperience();return e&&(0,a["default"])(this._funnelPrefix+"_complete"),n.fin(this.tutorial.onExit.bind(this.tutorial)).then(i)},_setStep:function R(e){return M.debug("set step from",this.currentStep,"to",e),(0,a["default"])(this._funnelPrefix+"_step"+e),0>e||e>=this.steps.length?this._endTutorial(!0).then(function(){throw new Error("step is out of range")}):(this.currentStep=e,this._saveCurrentStep(),this.tutorial.nextStep(e))},isRunningTutorial:function U(){return this._isActive},setTutorialActive:function C(e){this._isActive=e},_getStoredData:function L(){var e=T.sessionStorage.getItem(c.TUTORIAL_SESSION_KEY);return e&&e.experienceTutorial?e:null},canSupportExperience:function D(e){return u.has(this.TUTORIAL_MAP,e.type)&&u.has(e.display_data,"steps")},_saveCurrentStep:function F(){this.experience&&u.contains([11021,11020],this.experience.experience_id)||T.sessionStorage.setItem(c.TUTORIAL_SESSION_KEY,{experience:this.experience,step:this.currentStep,experienceTutorial:!0})},clearStoredData:function j(){T.sessionStorage.removeItem(c.TUTORIAL_SESSION_KEY)}};var E=null;y.instance=function(){return E||(E=new y),E},e.exports=l.expose("ExperienceTutorialManager",y)},758:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=i(14),s=n(r),o=i(11),a=i(13),u=i(46),l=i(9),c=i(956),d=i(96),p=i(73),h=i(322),_=i(265),f=i(47),m=i(37),v=i(117),x=i(60),S=i(283),T=f.getLogger("TutorialManager"),g=function E(e,t){this.url=e,this.forceRefresh=!!t},M=function P(){this.TUTORIAL_CONFIG={testTutorial:{stepNames:[],nextUrlInfo:function e(){return new g(null,!1)},canExit:!1,onUserExit:function t(){}},interestsNuxMweb:{stepNames:["NewUserWelcome","NewUserInterestPicker","NewUserSetupSpinner"],expiredSteps:{},canExit:!1,nextUrlInfo:function i(){return new g("/",!0)},onUserExit:function n(){}}},this.init()};M.prototype={init:function w(){this._isActive=!1,this.moduleContainer=null,this.renderModule=!0,this.progressModule=null,a("body").removeClass(this.tutorialClassName),this.tutorialName=null,this.tutorialClassName=null,this.tutorial=null,this.allStepNames=null,this.numTotalSteps=null,this.currentStep=null,this.isZoomedIn=!1,S.setTutorialManager(this)},startTutorial:function I(e,t){if(t=t||{},S.isTutorialActive())return Promise.reject(new Error("another tutorial is already active"));var i=this.TUTORIAL_CONFIG[e];return i?(this.moduleContainer=t.moduleContainer,this.renderModule=t.renderModule,this.progressModule=t.progressModule||this.progressModule,this._isActive?(this.renderModule===!1||this.currentModule||this._loadModuleForStep(this.currentStep),Promise.resolve()):(this._start(e,!0),Promise.resolve())):Promise.reject(new Error("tutorial config does not exist"))},setProgressModule:function A(e){this.progressModule!==e&&(this.progressModule=e,this.progressModule.listen(this.progressModule,"next",this._next.bind(this)),this.progressModule.listen(this.progressModule,"previous",this._previous.bind(this)),this._updateProgressModuleStep())},stopTutorial:function b(){this._isActive&&this.init()},resumeTutorial:function O(){if(!S.isTutorialActive()){var e=this._getStoredData();e&&e.name&&this._start(e.name,!1)}},_start:function N(e,t){var i=this.TUTORIAL_CONFIG[e];i&&(this._clear(t),this._isActive=!0,this.tutorialName=e,this.tutorialClassName=this.tutorialName+l.TUTORIAL_POSTFIX,a("body").addClass(this.tutorialClassName),this.tutorial=i,this.expiredSteps=this.tutorial.expiredSteps,this.allStepNames=this.tutorial.stepNames,this.numTotalSteps=this.tutorial.stepNames.length,this._funnelPrefix="tutorial_"+e,this.renderModule=this.renderModule!==!1,!this.moduleContainer&&this.renderModule||this._setStep(this._getStoredStep()||this.allStepNames[0]),h.log("tutorial."+e+"_started"))},isRunningTutorial:function R(){return this._isActive},_next:function U(){var e=this._getStepIndex(this.currentStep);return this.currentStep===o.last(this.allStepNames)?void this._endTutorial(!0):void this._setStep(this.allStepNames[e+1])},_previous:function C(){var e=this._getStepIndex(this.currentStep);return 0===e?(_.logToServer(_.SERVER_LOG_TYPE.LOG,_.HTTP_METHOD.POST,{type:"tutorial",tutorial:this.tutorialName,step:this.currentStep,step_number:e,action:"exit"}),this.tutorial.onUserExit(e),void this._endTutorial(!1)):void this._setStep(this.allStepNames[e-1])},_dismiss:function L(){this._endTutorial(!1)},_endTutorial:function D(e){var t=function(){var t=this.tutorial.nextUrlInfo().url,i=this.tutorial.nextUrlInfo().forceRefresh;if(this._clear(!0),e&&t){var n=new v;i&&(n.evt=new c("",null,{forceRefresh:1})),d.navigate(t,n)}}.bind(this),i=function(){var e=this;return this.progressModule?this.progressModule.endMandatoryFlow().then(function(){e.progressModule&&e.progressModule.remove();var t=p.instance;t.updateNavigationBar()}):Promise.resolve()}.bind(this),n=function(){var t=this,i=void 0;if(this.currentModule){var n=e?this.currentModule.completePlacedExperience():this.currentModule.dismissPlacedExperience();i=n.fin(function(){return new Promise(function(e){t.currentModule.onExit(e)})}),this.currentModule.onTutorialComplete()}else i=Promise.resolve();return i}.bind(this);n().then(i).then(t),e&&(0,s["default"])(this._funnelPrefix+"_complete")},_setStep:function F(e){var t=this;return(0,s["default"])(this._funnelPrefix+"_"+e),T.debug("set step from",this.currentStep,"to",e),e!==this.currentStep?(o.contains(this.allStepNames,e)||this.expiredSteps[e]||this._endTutorial(!0),this.expiredSteps[e]&&(e=this.expiredSteps[e]),this.currentStep=e,this._saveCurrentStep(),this.currentModule?void this.currentModule.onExit(function(){t.currentModule.onRemoved(),t._loadModuleForStep(e)}):void(this.renderModule&&this._loadModuleForStep(this.currentStep))):void 0},_setNextStepClass:function j(e){var t=a("body"),i=null,n=this._getStepIndex(e);n>0&&(i=this.allStepNames[n-1],t.removeClass(i+l.TUTORIAL_STEP_POSTFIX)),t.addClass(e+l.TUTORIAL_STEP_POSTFIX)},_updateProgressModuleStep:function k(){if(this.currentStep){var e=this._getStepIndex(this.currentStep);this._setNextStepClass(this.currentStep),this.progressModule&&this.progressModule.nextStep(e+1)}},_loadModuleForStep:function B(e){this.renderStepModule(e)},renderStepModule:function Y(e){var t=this,i=this.getModuleArgs(e);e=e?e:this.tutorial.stepNames[0],m.load(i).then(function(e){var i=t.currentModule;t.currentModule=e;var n=e;n.onEnter(function(){t._renderStepModule(e,i)})})},_renderStepModule:function G(e,t){var i=this;e.render().then(function(){var t=i.moduleContainer.children[0];i.moduleContainer.prependChild(e),t&&t.destroy(),e.onShow(i._updateProgressModuleStep())})},getModuleArgs:function K(e){var t=e,i={tutorial_name:this.tutorialName,current_step:this._getStepIndex(e),total_steps:this.numTotalSteps,can_exit:this.tutorial.canExit};return this.tutorial.stepExtraData&&this.tutorial.stepExtraData[e]&&(t=this.tutorial.stepExtraData[e].moduleName,Object.assign(i,this.tutorial.stepExtraData[e].options||{})),{name:t,options:i}},_getStepIndex:function V(e){var t=o.indexOf(this.allStepNames,e);return-1!==t?t:0},_getStoredStep:function H(){var e=this._getStoredData();return e&&e.name!==this.tutorialName&&(this._clearStoredData(),e=null),e&&e.step||null},_getStoredData:function W(){var e=x.sessionStorage.getItem(l.TUTORIAL_SESSION_KEY);return e&&e.experienceTutorial?null:e},_saveCurrentStep:function X(){x.sessionStorage.setItem(l.TUTORIAL_SESSION_KEY,{name:this.tutorialName,step:this.currentStep,experienceTutorial:!1})},_clear:function J(e){this.tutorial&&(this.stopTutorial(),e&&this._clearStoredData())},_clearStoredData:function Z(){x.sessionStorage.removeItem(l.TUTORIAL_SESSION_KEY)}};var y=null;M.instance=function(){return y||(y=new M),y},e.exports=u.expose("TutorialManager",M)},1066:function(e,t,i){"use strict";var n=i(46),r=i(45),s=i(37),o=function a(e,t){this.placedExperience=e,this.displayData=this.placedExperience.display_data,this.tutorialManager=t,this.storage={}};o.prototype={onStart:function u(){return new Promise(function(e,t){e(void 0)})},nextStep:function l(e){var t=this;return new Promise(function(i,n){t._removeStepModule().then(function(){t.loadStepModule(e),i(void 0)})})},loadStepModule:function c(e){var t=this,i=this.getModuleArgs(e);s.load(i).then(function(e){var i=t.currentModule;t.currentModule=e;var n=e;n.onEnter(function(){t.renderStepModule(e,i)})})},getCurrentViewParameterType:function d(){return this.currentModule&&this.currentModule.getCurrentViewParameterType?this.currentModule.getCurrentViewParameterType():null},renderStepModule:function p(e,t){},_removeStepModule:function h(){var e=this.currentModule;return new Promise(function(t){e&&e.onExit(function(){e.onRemoved()}),t(void 0)})},getModuleArgs:function _(e){var t=this.displayData.steps,i=t[e].moduleName,n={tutorial_name:this.displayData.tutorialName,current_step:e,total_steps:t.length,can_exit:this.displayData.can_exit||!1,experienceID:this.placedExperience.experience_id,placementID:this.placedExperience.placement_id};return Object.assign(n,t[e].options),{name:i,options:n}},onExit:function f(){var e=this;return this._removeStepModule().then(function(){return e.currentModule&&e.currentModule.destroy(),Promise.resolve()})},dismissTutorial:function m(){this.tutorialManager&&this.tutorialManager.isRunningTutorial()&&this.tutorialManager._dismiss()},completePlacedExperience:function v(){return this.currentModule?this.currentModule.completePlacedExperience():this.placedExperience&&this.placedExperience.id?r.instance.completePlacedExperienceId(this.placedExperience.id):Promise.resolve()},dismissPlacedExperience:function x(){return this.currentModule?this.currentModule.dismissPlacedExperience():this.placedExperience&&this.placedExperience.id?r.instance.dismissPlacedExperienceId(this.placedExperience.id):Promise.resolve()},getStorage:function S(e){return this.storage[e]},setStorage:function T(e,t){this.storage[e]=t}},e.exports=n.expose("ExperienceTutorial",o)},1397:function(e,t,i){"use strict";var n=i(11),r=i(13),s=i(46),o=i(1066),a=i(47),u=i(62),l=i(18),c=a.getLogger("ModalTutorial"),d=function p(e,t){o.call(this,e,t),this.modal=null};d.prototype=Object.create(o.prototype),d.prototype.onStart=function(){var e=this;return new Promise(function(t,i){return e.displayData.anchor&&!e._isOnScreen(r(e.displayData.anchor))?void i(new Error("Highlighted element is not on screen.")):void t(void 0)})},d.prototype.onExit=function(){this.modal&&(this.modal.destroy(),this.modal=null),o.prototype.onExit.call(this)},d.prototype.renderStepModule=function(e,t){var i=this,r=void 0;if(this.modal){var s=function a(){t&&t.destroy()};r=this.modal.setSubmodule(e).then(s,s)}else{var o=(this.displayData.modalStyle+" "||"")+l.attributes.gender;r=u.get().createAndShowModalCorrect(e,{mask_type:"dark",can_dismiss:!1,modal_style:o}).then(function(t){i.modal=t,e.modal=t,i.modal.childListen("next",i.tutorialManager._next.bind(i.tutorialManager)),i.modal.childListen("previous",i.tutorialManager._previous.bind(i.tutorialManager))})}return r.then(function(){n.isUndefined(e.setModalPosition)||e.setModalPosition(),e.onShow()})["catch"](function(e){c.debug(e)})},d.prototype._isOnScreen=function(e){if(e.length){var t=r(window),i=t.scrollTop(),n=i+t.height(),s=e.offset().top,o=s+e.height();return n>=o&&s>=i}return!1},e.exports=s.expose("ModalTutorial",d)},1800:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=i(14),s=n(r),o=i(11),a=i(2731),u=i(2729),l=i(2727),c=i(115),d=i(2728),p=i(45),h=i(718),_=i(2730),f=i(758),m=i(62),v=i(37),x=i(7),S=i(207),T=i(283),g={};g.launchPlacedExperience=function(e,t,i){var n=p.instance;return n.getPlacedExperienceWithContext(e,t).then(function(t){return t?g.launchFetchedPlacedExperience(t,e,i):Promise.resolve(!1)})},g.launchFetchedPlacedExperience=function(e,t,i){var n=p.instance;if(e.placement_id=t,h.instance().canSupportExperience(e))return h.instance().startTutorial(e).then(function(){return n.viewPlacedExperience(t,e.experience_id),Promise.resolve(!0)});if(8===e.type)return _().then(function(t){var i=new t({options:{anchor:e.display_data.anchor,append_to:e.display_data.append_to,experience:e,tooltip_only:e.display_data.tooltip_only,dismiss_on_event_types:e.display_data.dismiss_on_event_types,tooltip_options:Object.assign({},e.display_data),usm_placed_experience:e.usm_experience?e:null}});return i.render().then(function(){return x.instance.publish("site","appendToMainModule",{module:i}),!0})});if(10026===e.experience_id){if(!T.isTutorialActive())return u().then(function(t){var i=new t({options:{placedExperienceId:e.id}});return m.get().createAndShowModal(i,{only_modal:!0}),!0})}else if(500136===e.experience_id){if(!T.isTutorialActive())return d().then(function(t){var i=new t({resource:{name:"NetworkStoryByTypeResource",options:{story_type:"SYSTEM_BOARD_CREATE_RECS_FROM_EMAIL"}},options:{experience_id:e.experience_id,placement_id:e.placement_id,not_usm:!0}});return m.get().createAndShowModal(i,{only_modal:!0}),!0})}else{if(o.contains([11019,11023,500110,500131,500207],e.experience_id))return l().then(function(t){var i=new t({options:{banner_text:e.display_data.banner_text,banner_string_unsafe:e.display_data.banner_string_unsafe,transition_button:e.display_data.transition_button,transition_event:e.display_data.transition_event,transition_text:e.display_data.transition_text,transition_string_unsafe:e.display_data.transition_string_unsafe,placed_experience_id:e.id,experience_id:e.experience_id}});return i.render().then(function(){return x.instance.publish("site","appendToMainModule",{module:i}),!0})});if(5===e.type){if(i)return c().then(function(r){var o=new r({options:e.display_data});return m.get().createAndShowModal(o,{mask_type:"dark",can_dismiss:!1}),n.viewPlacedExperience(t,e.experience_id),(0,s["default"])("web_survey_viewed"),i.listen(o,"confirm",function(){window.open(e.display_data.uri),n.completePlacedExperience(t,e.experience_id),(0,s["default"])("web_survey_completed")}),i.listen(o,"close",function(){n.dismissPlacedExperience(t,e.experience_id),(0,s["default"])("web_survey_dismissed")}),!0})}else{if(10===e.type)return e.display_data.module?(n.viewPlacedExperienceId(e.id),v.load({name:e.display_data.module}).then(function(e){return S().then(function(t){return t.addToast(e),!0})})):Promise.resolve(!1);if(500006===e.experience_id){if(!T.isTutorialActive())return a().then(function(e){var t=new e,i={only_modal:!0,log_component_type:162,mask_type:"dark",can_dismiss:!1};return m.get().createAndShowModal(t,i),!0})}else{var r=g.Tutorials[e.experience_id];if(r)return f.instance().startTutorial(r,{display_data:e.display_data}).then(function(){return n.viewPlacedExperience(t,e.experience_id),Promise.resolve(!0)})}}}},g.Tutorials={},g.Tutorials[10010]="firstPinIntro",g.Tutorials[10011]="yourBoards",g.Tutorials[40002]="interestsNuxMweb",g.Tutorials[60001]="analyticsHomeUserEd",g.Tutorials[60002]="analyticsAudienceSelectorUserEd",g.Tutorials[11002]="emptyBoardIntro",g.Tutorials[11004]="emptyBoardIntro",g.Tutorials[11007]="repin",g.Tutorials[11009]="repin",g.Tutorials[11024]="flashlightGuide",g.Tutorials[11026]="flashlightPulser",e.exports=g},1922:function(e,t,i){"use strict";var n=i(36),r=i(27),s=i(1066),o=i(1923),a=function u(e,t){s.call(this,e,t),this.SUB_TUTORIAL_MAP={modal:o},this._subTutorial=null;var i=void 0;this.displayData.modal?i=o:this.SUB_TUTORIAL_MAP[this.displayData.sub_type]&&(i=this.SUB_TUTORIAL_MAP[this.displayData.sub_type]),i&&(this._subTutorial=new i(this.placedExperience,this.tutorialManager))};a.prototype=Object.create(s.prototype),a.prototype.onStart=function(){return this._subTutorial.onStart()},a.prototype.onExit=function(){return this._subTutorial.onExit().then(function(){var e={event_type:4105,view_type:24},t=n.fromPlainObject(e);r.getInstance().addEvent(t)})},a.prototype.nextStep=function(e){var t=this;return this._subTutorial.nextStep(e).then(function(){if(0===e){var t={event_type:4104,view_type:24},i=n.fromPlainObject(t);r.getInstance().addEvent(i)}}).then(function(){var e=t._subTutorial.getCurrentViewParameterType();if(e){var i={event_type:13,view_type:24,view_parameter:e},s=n.fromPlainObject(i);r.getInstance().addEvent(s)}})},e.exports=a},1923:function(e,t,i){"use strict";var n=i(1397),r=i(62),s=function o(e,t){n.call(this,e,t)};s.prototype=Object.create(n.prototype),s.prototype.onExit=function(){var e=this.modal;return e?(this.modal=null,r.get().removeModalWithAnimation(e,".flexibleSetup",500)):Promise.resolve()},e.exports=s},2727:function(e,t,i){e.exports=function(){return new Promise(function(e){i.e(146,function(t){e(i(1284))})})}},2728:function(e,t,i){e.exports=function(){return new Promise(function(e){i.e(142,function(t){e(i(1813))})})}},2729:function(e,t,i){e.exports=function(){return new Promise(function(e){i.e(143,function(t){e(i(1285))})})}},2730:function(e,t,i){e.exports=function(){return new Promise(function(e){i.e(147,function(t){e(i(1814))})})}},2731:function(e,t,i){e.exports=function(){return new Promise(function(e){i.e(145,function(t){e(i(1815))})})}}});